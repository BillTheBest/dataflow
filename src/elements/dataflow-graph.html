<!-- Custom elements -->
<link rel="import" href="dataflow-edge.html">
<link rel="import" href="dataflow-node.html">

<polymer-element name="dataflow-graph" attributes="graph">
  <template>

    <div id="edges">
      <template repeat="{{connections}}">
        <dataflow-edge sourcenode="{{src.process}}" sourceport="{{src.port}}" targetnode="{{tgt.process}}" targetport="{{tgt.port}}"></dataflow-edge>
      </template>
    </div>
    <div id="nodes">
      <template repeat="{{processes}}">
        <dataflow-node id="{{id}}" type="{{type}}" label="{{metadata.label}}"></dataflow-node>
      </template>
    </div>

  </template>
  <script>
    Polymer("dataflow-graph", {
      created: function() {
        console.log(this);
        if (this.graph) {
          this.graphChanged();
        }
      },
      graphChanged: function () {
        if (typeof this.graph === "string") {
          this.parsedGraph = JSON.parse( this.graph );
        } else {
          this.parsedGraph = this.graph;
        }
        this.processes = this.parsedGraph.processes;
        this.connections = this.parsedGraph.connections;
      }
    });
  </script>
</polymer-element>
